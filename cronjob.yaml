apiVersion: batch/v1beta1
kind: CronJob
metadata:
  name: subcellbkp
spec:
  schedule: "*/60 * * * *"
  concurrencyPolicy: "Forbid"
  startingDeadlineSeconds: 200
  suspend: false
  successfulJobsHistoryLimit: 3
  failedJobsHistoryLimit: 1
  jobTemplate:
    spec:
      template:
        metadata:
          labels:
            parent: "cronjobpi"
        spec:
          volumes:
            - name: subcellular-backup
              persistentVolumeClaim:
                claimName: subcellular-backup
          containers:
            - name: subcellbkp
              image: docker-registry.ebrains.eu/bsp-epfl/mongo_backup
              command: ["/backup.sh"]
              volumeMounts:
                - name: subcellular-backup
                  mountPath: /subcellular-backup
          restartPolicy: OnFailure
